# ステップ5：条件に一致する行を抽出する
このステップでは**WHERE句**を使用して条件に一致するレコードを抽出する方法を学びます。  

## WHERE句による行の絞り込み
WHERE句で条件を指定することで、条件に一致するレコードを抽出することができます。  
例えばあるカラムの値が特定の値に一致する場合などです。  
WHERE句はFROM句の後ろに配置します。  

```sql
SELECT * FROM テーブル名 WHERE 条件;
```

それでは実際に行を抽出するSELECT文を実行してみましょう。  

## ハンズオン
shopテーブルよりlocationカラムの値が「東京」であるレコードを取得します。  
以下のSQL文をコピーしSQL Fiddleの**SQLパネル(右側のパネル)**に貼り付け、**Run SQL**ボタンをクリックしてみましょう。  

**[5-1]shopテーブルよりlocationカラムの値が「東京」であるレコードを抽出**
```sql
SELECT * FROM shop WHERE location = '東京';
```

![WHERE句](https://user-images.githubusercontent.com/22129880/92434432-bdefdf00-f1da-11ea-9744-c8e5e311a697.png)

画像のようにlocationカラムの値が東京であるレコードのみ抽出されていることがわかると思います。  

なお、SQLでは文字列の値を記述する場合は上記のように**'(シングルクォーテーション)**で囲むルールとなっています。  
こちらも忘れないようにしましょう。  

## WHERE句の条件で使用できる演算子
WHERE句では等しいことを表す「=」以外にも様々な演算子を使用することができます。  

|演算子|説明|
| --- | --- |
| > | 大きい |
| < | 小さい |
| >= | 以上 |
| <= | 以下 |
| = | 等しい |
| != または <> | 等しくない |
| NOT | 式の結果を反転 |
| BETWEEN a AND b | aとbの範囲内 |
| IN | 指定した複数の値のどれかに一致 |
| LIKE | 指定パターンに一致(あいまい検索) |

いくつか例をみてみましょう。  
(時間がある場合は実際に試してみてください。)  

**[5-2]月間売上が200万円以上の店舗を抽出する**  
```sql
SELECT * FROM shop WHERE sales >= 200;
```

**[5-3]20代のユーザーを抽出する**  
```sql
SELECT * FROM user WHERE age BETWEEN 20 AND 29;
```

**[5-4]店舗名が「◯◯ラーメン」のものを抽出する**  
```sql
SELECT * FROM shop WHERE name LIKE '%ラーメン';
```

LIKE句における%は**ワイルドカード**と呼ばれ、任意の文字列にマッチします。  
%の位置により前方一致、後方一致、部分一致を実現できます。

|検索タイプ|%の位置|
| --- | --- |
|前方一致|検索ワード%|
|後方一致|%検索ワード|
|部分一致|%検索ワード%|


## 複数の条件を指定する
AND句やOR句を使用することで複数の条件を指定することが可能です。  
AND句はすべての条件を満たす場合に真、OR句はいずれか1つの条件を満たす場合に真となります。

**[5-5]神奈川県にあり、かつ売上が200万未満の店舗を抽出**  
```sql
SELECT * FROM shop WHERE location = '神奈川' AND sales < 200;
```

**[5-6]男性または20歳未満であるユーザーを抽出**  
```sql
SELECT * FROM user WHERE sex = '男性' OR age < 20;
```

## 練習問題
1. visitテーブルのrankカラムの値が5であるレコードを抽出してみましょう。  
2. shopテーブルよりlocationカラムが「東京」かつsalesカラムの値が200よりも大きいレコードを抽出してみましょう。  
さらに、表示するカラムをname, locationn, salesに絞り込んでください。  

回答は[こちら](005-where-answer.md)  

前のステップ：[列を絞り込む](004-select-columns.md)  
次のステップ：[並び替えと制限](006-sort-and-limit.md)  
[目次に戻る](README.md)
